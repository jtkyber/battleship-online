(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{103:function(e,t,n){},207:function(e,t,n){},208:function(e,t,n){},209:function(e,t,n){},462:function(e,t,n){},464:function(e,t,n){},468:function(e,t,n){},469:function(e,t,n){},470:function(e,t,n){},471:function(e,t,n){},501:function(e,t,n){},502:function(e,t,n){},503:function(e,t,n){},504:function(e,t,n){},505:function(e,t,n){"use strict";n.r(t);n(139),n(238),n(278);var r=n(1),s=n(106),c=n.n(s),a=(n(462),n(7)),o=n.n(a),i=n(35),u=n(22),d=n(15),l=(n(103),n(0)),h=function(e){for(var t=e.gameRoute,n=(e.route,e.onSquareClicked),r=[],s=1;s<11;s++)for(var c=0;c<10;c++)r.push({row:String.fromCharCode(97+c),col:s,colStart:s,rowStart:c+1});var a=function(e){var r=e.target.parentElement.parentElement.parentElement;"gameInProgress"===t&&r.classList.contains("opponentBoard")&&n(e)};return r.map((function(e){return Object(l.jsx)("div",{onClick:a,style:{gridArea:e.row+e.col},className:"singleSquare "+e.row+" "+e.row+e.col,id:e.colStart+"-"+e.rowStart},e.row+e.col)}))},j=n(30),f=n.n(j),b=(n(464),function(e){var t=e.gameRoute,n=(e.route,!1),r="hor",s="",c="",a=!1,o=!1,u=function(e){if(!a&&"placeShips"===t){var n=document.querySelector(".userBoard");a=!0,s=e.target.parentElement,n.style.cursor="pointer",s.style.zIndex="-2",s.style.border="2px solid rgba(0, 250, 0, 0.5)",parseInt(e.target.parentElement.offsetWidth)>parseInt(e.target.parentElement.offsetHeight)?r="hor":parseInt(e.target.parentElement.offsetHeight)>parseInt(e.target.parentElement.offsetWidth)&&(r="vert"),s.classList.contains("carrier")?c="carrier":s.classList.contains("battleship")?c="battleship":s.classList.contains("cruiser")?c="cruiser":s.classList.contains("submarine")?c="submarine":s.classList.contains("destroyer")&&(c="destroyer")}},d=function(e,t){var n=f()(e).offset(),r=f()(e).outerHeight(!0),s=f()(e).outerWidth(!0),c=n.top+r,a=n.left+s,o=f()(t).offset(),i=f()(t).outerHeight(!0),u=f()(t).outerWidth(!0),d=o.top+i,l=o.left+u;return!(c<=o.top+2||n.top>=d-2||a<=o.left+2||n.left>=l-2)};document.addEventListener("click",(function(e){a&&e.target.classList.contains("singleSquare")&&!1===n&&h()&&(s.style.zIndex="3",document.querySelector(".userBoard").style.cursor="default",s.style.border=null,a=!1)}));var h=function(){var e,t=document.querySelectorAll(".ship"),n=Object(i.a)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!r.classList.contains(c)&&d(s,r))return console.log(r.className),!1}}catch(a){n.e(a)}finally{n.f()}return!0};return window.oncontextmenu=function(e){return a&&("hor"===r?(s.style.transform="rotate(-90deg)",r="vert"):"vert"===r&&(s.style.transform="rotate(0deg)",r="hor"),o=!0,n=!0),!1},document.addEventListener("keydown",(function(e){13===e.keyCode&&e.preventDefault(),32===e.keyCode&&void 0!==s.style&&a&&("hor"===r?(s.style.transform="rotate(-90deg)",r="vert"):"vert"===r&&(s.style.transform="rotate(0deg)",r="hor"),o=!0,n=!0)})),window.onmouseover=function(e){if(a){n=!1,s.style.transform=null;var t=document.querySelector(".userBoard"),i=document.querySelector(".".concat(c,"Icon")),u=e.target.id,d=u.substring(0,u.indexOf("-")),l=u.substring(u.indexOf("-")+1,u.length);t.contains(e.target)&&e.target.classList.contains("singleSquare")&&!0===a&&("hor"===r?(i.classList.remove("rotate-".concat(c)),d<11-parseInt(s.id)+1?s.style.gridColumn="".concat(d," / ").concat(parseInt(d)+parseInt(s.id)):d>=11-parseInt(s.id)+1&&!0===o?s.style.gridColumn="11 / ".concat(11-parseInt(s.id)):o=!1,s.style.gridRow="".concat(l," / ").concat(parseInt(l)+1)):"vert"===r&&(i.classList.add("rotate-".concat(c)),l>parseInt(s.id)-1?s.style.gridRow="".concat(parseInt(l)+1," / ").concat(parseInt(l)-parseInt(s.id)+1):l<=parseInt(s.id)-1&&!0===o?s.style.gridRow="".concat(parseInt(s.id)+1," / 1"):o=!1,s.style.gridColumn="".concat(d," / ").concat(parseInt(d)+1)))}},Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{id:"5",className:"ship carrier",children:Object(l.jsx)("div",{onClick:u,className:"carrierIcon"})}),Object(l.jsx)("div",{id:"4",className:"ship battleship",children:Object(l.jsx)("div",{onClick:u,className:"battleshipIcon"})}),Object(l.jsx)("div",{id:"3",className:"ship cruiser",children:Object(l.jsx)("div",{onClick:u,className:"cruiserIcon"})}),Object(l.jsx)("div",{id:"3",className:"ship submarine",children:Object(l.jsx)("div",{onClick:u,className:"submarineIcon"})}),Object(l.jsx)("div",{id:"2",className:"ship destroyer",children:Object(l.jsx)("div",{onClick:u,className:"destroyerIcon"})})]})}),p=function(e){e.yourTurn;var t=e.setYourTurn,n=e.gameRoute,s=e.socket,c=e.friendSocket,a=e.route;Object(r.useEffect)((function(){return s.on("receive shot",(function(e){var n=document.getElementById(e);u(n),t(!0)})),function(){s.off("receive shot")}}),[]);var o=function(e,t){var n=f()(e).offset(),r=f()(e).outerHeight(!0),s=f()(e).outerWidth(!0),c=n.top+r,a=n.left+s,o=f()(t).offset(),i=f()(t).outerHeight(!0),u=f()(t).outerWidth(!0),d=o.top+i,l=o.left+u;return!(c<=o.top+2||n.top>=d-2||a<=o.left+2||n.left>=l-2)},u=function(e){d(e)?(e.classList.add("hit"),s.emit("send result to opponent board",{shotSquare:e.id,shot:"hit",socketid:c})):(e.classList.add("miss"),s.emit("send result to opponent board",{shotSquare:e.id,shot:"miss",socketid:c}))},d=function(e){var t,n=document.querySelectorAll(".ship"),r=Object(i.a)(n);try{for(r.s();!(t=r.n()).done;){var s=t.value;if(o(e,s))return!0}}catch(c){r.e(c)}finally{r.f()}return!1};return Object(l.jsxs)("div",{className:"board userBoard",children:[Object(l.jsxs)("div",{className:"rows",children:[Object(l.jsx)("h3",{children:"A"}),Object(l.jsx)("h3",{children:"B"}),Object(l.jsx)("h3",{children:"C"}),Object(l.jsx)("h3",{children:"D"}),Object(l.jsx)("h3",{children:"E"}),Object(l.jsx)("h3",{children:"F"}),Object(l.jsx)("h3",{children:"G"}),Object(l.jsx)("h3",{children:"H"}),Object(l.jsx)("h3",{children:"I"}),Object(l.jsx)("h3",{children:"J"})]}),Object(l.jsxs)("div",{className:"cols",children:[Object(l.jsx)("h3",{children:"1"}),Object(l.jsx)("h3",{children:"2"}),Object(l.jsx)("h3",{children:"3"}),Object(l.jsx)("h3",{children:"4"}),Object(l.jsx)("h3",{children:"5"}),Object(l.jsx)("h3",{children:"6"}),Object(l.jsx)("h3",{children:"7"}),Object(l.jsx)("h3",{children:"8"}),Object(l.jsx)("h3",{children:"9"}),Object(l.jsx)("h3",{children:"10"})]}),Object(l.jsx)("div",{className:"grid",children:Object(l.jsxs)("div",{className:"allSqaures",children:[Object(l.jsx)(h,{gameRoute:n}),Object(l.jsx)(b,{gameRoute:n,route:a})]})})]})},m=function(e){var t=e.yourTurn,n=e.setYourTurn,s=e.gameRoute,c=e.socket,a=e.friendSocket,o=e.route;Object(r.useEffect)((function(){return c.on("show result on opponent board",(function(e){var t=document.querySelector(".opponentBoard [id='".concat(e.shotSquare,"']"));"hit"===e.result&&void 0!==t.classList?t.classList.add("hit"):"miss"===e.result&&void 0!==t.classList&&t.classList.add("miss")})),function(){c.off("show result on opponent board")}}),[]);return Object(l.jsxs)("div",{className:"board opponentBoard",children:[Object(l.jsxs)("div",{className:"rows",children:[Object(l.jsx)("h3",{children:"A"}),Object(l.jsx)("h3",{children:"B"}),Object(l.jsx)("h3",{children:"C"}),Object(l.jsx)("h3",{children:"D"}),Object(l.jsx)("h3",{children:"E"}),Object(l.jsx)("h3",{children:"F"}),Object(l.jsx)("h3",{children:"G"}),Object(l.jsx)("h3",{children:"H"}),Object(l.jsx)("h3",{children:"I"}),Object(l.jsx)("h3",{children:"J"})]}),Object(l.jsxs)("div",{className:"cols",children:[Object(l.jsx)("h3",{children:"1"}),Object(l.jsx)("h3",{children:"2"}),Object(l.jsx)("h3",{children:"3"}),Object(l.jsx)("h3",{children:"4"}),Object(l.jsx)("h3",{children:"5"}),Object(l.jsx)("h3",{children:"6"}),Object(l.jsx)("h3",{children:"7"}),Object(l.jsx)("h3",{children:"8"}),Object(l.jsx)("h3",{children:"9"}),Object(l.jsx)("h3",{children:"10"})]}),Object(l.jsx)("div",{className:"grid",children:Object(l.jsx)("div",{className:"allSqaures",children:Object(l.jsx)(h,{gameRoute:s,route:o,onSquareClicked:function(e){!t||e.target.classList.contains("hit")||e.target.classList.contains("miss")||(c.emit("send shot to opponent",{target:e.target.id,socketid:a}),n(!1))}})})})]})},x=(n(207),n.p+"static/media/msg-icon.b63e7a13.png"),g=n(510),O=function(e){var t=e.setUnsortedFriends,n=e.socket,s=e.username,c=Object(r.useState)([]),a=Object(d.a)(c,2),h=a[0],j=a[1];Object(r.useEffect)((function(){return f(),n.on("receive friend request",(function(){f()})),function(){n.off("receive friend request")}}),[]);var f=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelector("nav"),e.prev=1,e.next=4,fetch("https://calm-ridge-60009.herokuapp.com/getFriendRequests?username=".concat(s));case 4:if((n=e.sent).ok){e.next=7;break}throw new Error("Could not get friend requests");case 7:return e.next=9,n.json();case 9:null!==(r=e.sent)&&""!==r?(t.style.setProperty("--notification-color","rgba(255,0,0,0.8)"),j(r.split(","))):(t.style.setProperty("--notification-color","transparent"),j(null)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,c,a,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,e.next=4,fetch("https://calm-ridge-60009.herokuapp.com/getFriendRequests?username=".concat(s));case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Could not get friend requests");case 7:return e.next=9,r.json();case 9:return null!==(c=e.sent)&&""!==c&&((a=c.split(",")).length<=1?n=null:(i=a.indexOf(t))>-1&&(a.splice(i,1),n=a.join(","))),e.next=13,fetch("https://calm-ridge-60009.herokuapp.com/updateFriendRequests",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestlist:n,username:s})});case 13:if((u=e.sent).ok){e.next=16;break}throw new Error("Could not update friend requests");case 16:return e.next=18,u.json();case 18:e.sent&&f(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),console.log(e.t0);case 25:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e){b(e.target.id)},m=function(){var e=Object(u.a)(o.a.mark((function e(r){var c,a,u,d,l,h,j,f,b,p,m,x,g,O,v,k,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("friend added"),document.querySelector(".addFriendInput").value="",c="",a=[],u="",d="",e.prev=6,e.next=9,fetch("https://calm-ridge-60009.herokuapp.com/findFriend?username=".concat(r));case 9:if((l=e.sent).ok){e.next=12;break}throw new Error("User does not exist");case 12:return e.next=14,l.json();case 14:if((h=e.sent).username!==s){e.next=19;break}throw new Error("Cannot add self as friend");case 19:if(!h.username){e.next=92;break}if(j=[],d=h.socketid,null===h.friends||""===h.friends){e.next=26;break}if(!(j=h.friends.split(",")).includes(s)){e.next=26;break}throw new Error("You are already a friend of the user");case 26:return j.push(s),u=j.length>1?j.join(","):j[0],e.next=30,fetch("https://calm-ridge-60009.herokuapp.com/getFriends?username=".concat(s));case 30:if((f=e.sent).ok){e.next=33;break}throw new Error("Problem accessing friends list");case 33:return e.next=35,f.json();case 35:if(null===(b=e.sent)||""===b){e.next=40;break}if(!(a=b.split(",")).includes(r)){e.next=40;break}throw new Error("User already your friendddddddd");case 40:return a.push(r),c=a.length>1?a.join(","):a[0],e.next=44,fetch("https://calm-ridge-60009.herokuapp.com/addFriend",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,friendlist:c})});case 44:if((p=e.sent).ok){e.next=47;break}throw new Error("Problem adding friend");case 47:return e.next=49,p.json();case 49:if(!e.sent){e.next=83;break}m=[],x=Object(i.a)(a),e.prev=53,x.s();case 55:if((g=x.n()).done){e.next=74;break}return O=g.value,e.prev=57,e.next=60,fetch("https://calm-ridge-60009.herokuapp.com/findFriend?username=".concat(O));case 60:if((v=e.sent).ok){e.next=63;break}throw new Error("User does not exist");case 63:return e.next=65,v.json();case 65:(k=e.sent).socketid?m.push({name:k.username,status:"online"}):m.push({name:k.username,status:"offline"}),e.next=72;break;case 69:e.prev=69,e.t0=e.catch(57),console.log(e.t0);case 72:e.next=55;break;case 74:e.next=79;break;case 76:e.prev=76,e.t1=e.catch(53),x.e(e.t1);case 79:return e.prev=79,x.f(),e.finish(79);case 82:t(m);case 83:return e.next=85,fetch("https://calm-ridge-60009.herokuapp.com/addSelfToFriend",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({friendlist:u,friendname:r})});case 85:if((y=e.sent).ok){e.next=88;break}throw new Error("Problem adding self to friendlist of friend");case 88:return e.next=90,y.json();case 90:e.sent&&null!==d&&n.emit("update user status",d);case 92:e.next=97;break;case 94:e.prev=94,e.t2=e.catch(6),console.log(e.t2);case 97:case"end":return e.stop()}}),e,null,[[6,94],[53,76,79,82],[57,69]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://calm-ridge-60009.herokuapp.com/findFriend?username=".concat(t.target.id));case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("User does not exist");case 6:return e.next=8,n.json();case 8:e.sent.username&&(b(t.target.id),m(t.target.id)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)(g.a,{className:"dropdown",children:[Object(l.jsx)(g.a.Toggle,{variant:"success",className:"messageToggle",id:"dropdown-basic",children:Object(l.jsx)("img",{src:x,alt:"Message Icon"})}),Object(l.jsx)(g.a.Menu,{id:"dropdowns",children:null!==h?h.map((function(e){return Object(l.jsxs)("div",{className:"dropdownItem",children:[Object(l.jsxs)("div",{className:"text",children:["Friend request from ",Object(l.jsx)("h3",{className:"requesterName",children:e})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("button",{onClick:O,id:e,className:"acceptInvite",children:"Accept"}),Object(l.jsx)("button",{onClick:p,id:e,className:"rejectInvite",children:"Reject"})]})]},e)})):null})]})})},v=function(e){var t=e.friendSocket,n=e.setUnsortedFriends,r=e.socket,s=e.username,c=e.onRouteChange,a=e.route;return Object(l.jsx)("nav",{className:"nav",children:"loggedIn"===a?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(O,{setUnsortedFriends:n,socket:r,username:s}),Object(l.jsx)("button",{value:"goToLeaderboard",onClick:c,children:"Leaderboard"}),Object(l.jsx)("button",{value:"goToLogin",onClick:c,children:"Log Out"})]}):Object(l.jsx)(l.Fragment,{children:"leaderboard"===a?s?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(O,{setUnsortedFriends:n,socket:r,username:s}),Object(l.jsx)("button",{value:"goHome",onClick:c,children:"Home"}),Object(l.jsx)("button",{value:"goToLogin",onClick:c,children:"Log Out"})]}):Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("button",{value:"goToLogin",onClick:c,children:"Back"})}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(O,{setUnsortedFriends:n,socket:r,username:s}),Object(l.jsx)("button",{value:"goHome",onClick:function(e){c(e),r.emit("send exit game",t)},children:"Exit"}),Object(l.jsx)("button",{value:"goToLogin",onClick:c,children:"Log Out"})]})})})},k=(n(468),function(){return Object(l.jsx)("footer",{children:Object(l.jsx)("div",{className:"footer"})})}),y=function(e){var t=e.handleReadyButton;return Object(l.jsx)("div",{className:"readyBtn",children:Object(l.jsx)("button",{onClick:t,className:"btn",children:Object(l.jsx)("h3",{children:"Ready!"})})})},w=function(e){var t=e.setRoute,n=e.setUnsortedFriends,s=e.socket,c=e.username,a=e.onRouteChange,h=e.route,j=e.friendSocket,f=Object(r.useState)("placeShips"),b=Object(d.a)(f,2),x=b[0],g=b[1],O=Object(r.useState)(!1),w=Object(d.a)(O,2),S=w[0],C=w[1],N=Object(r.useState)(!1),F=Object(d.a)(N,2),q=F[0],E=F[1],I=Object(r.useState)(!1),L=Object(d.a)(I,2),R=L[0],T=L[1];Object(r.useEffect)((function(){return s.on("receive game over",(function(){U(),setTimeout((function(){window.alert("You Won!!!"),t("loggedIn")}),300)})),s.on("receive exit game",(function(){window.alert("Opponent has left the game"),t("loggedIn")})),function(){s.off("receive ready status"),s.off("receive game over"),s.off("receive exit game")}}),[]),Object(r.useEffect)((function(){var e=document.querySelector(".gamePage");"placeShips"===x?e.style.setProperty("--player-turn-text",'"Place your ships!"'):R?e.style.setProperty("--player-turn-text",'"Your Turn!"'):e.style.setProperty("--player-turn-text",'"Opponent\'s Turn!"')}),[R,x]),Object(r.useEffect)((function(){var e=document.querySelectorAll(".userBoard .singleSquare"),n=0;if(R){var r,c=Object(i.a)(e);try{for(c.s();!(r=c.n()).done;){r.value.classList.contains("hit")&&(n+=1)}}catch(a){c.e(a)}finally{c.f()}n>=17&&(s.emit("game over",j),setTimeout((function(){window.alert("You Lose"),t("loggedIn")}),300))}}),[R]);var U=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://calm-ridge-60009.herokuapp.com/updateWins",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:c})});case 3:return t=e.sent,e.next=6,t.json();case 6:if(e.sent){e.next=9;break}throw new Error("Could not increment wins");case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();s.on("receive ready status",(function(){S&&g("gameInProgress"),E(!0)}));return Object(l.jsxs)("div",{className:"gamePage",children:[Object(l.jsx)(v,{friendSocket:j,setUnsortedFriends:n,socket:s,username:c,onRouteChange:a,route:h}),Object(l.jsx)(p,{yourTurn:R,setYourTurn:T,gameRoute:x,socket:s,friendSocket:j,route:h}),"placeShips"===x?Object(l.jsx)(y,{handleReadyButton:function(){var e,t=document.querySelectorAll(".ship"),n=document.querySelector(".readyBtn"),r=Object(i.a)(t);try{for(r.s();!(e=r.n()).done;){e.value.style.cursor="default"}}catch(c){r.e(c)}finally{r.f()}q?(g("gameInProgress"),T(!0)):n.style.opacity="0.4",C(!0),s.emit("send ready status",j)}}):null,Object(l.jsx)(m,{yourTurn:R,setYourTurn:T,gameRoute:x,socket:s,friendSocket:j,route:h}),Object(l.jsx)(k,{})]})},S=(n(469),function(e){var t=e.route;return Object(l.jsx)("div",{className:"board homeBoard",children:Object(l.jsx)("div",{className:"grid",children:Object(l.jsx)("div",{className:"allSqaures",children:Object(l.jsx)(h,{route:t})})})})}),C=(n(470),function(e){var t=e.socket,n=e.route,s=e.setFriendSocket,c=e.currentSocket,a=e.username,i=(e.fetchFriends,e.name),d=e.status,h=e.setRoute,j="";Object(r.useEffect)((function(){return t.on("receive go to game",(function(){h("game")})),function(){t.off("receive go to game"),t.off("receive invite")}}),[]),t.on("receive invite",(function(e){var t=document.querySelector(".btn".concat(e.username));"loggedIn"===n&&null!==t&&(!0===t.disabled&&(t.style.backgroundColor="rgba(0,255,50,0.7)",t.style.border="2px solid rgba(255,255,255,0.5)",t.style.color="rgba(0,0,0,1)",t.disabled=!1),t.childNodes[0].nodeValue="Accept",j=e.socketid)}));var f=function(){var e=Object(u.a)(o.a.mark((function e(n){var r,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.target.id,e.prev=1,e.next=4,fetch("https://calm-ridge-60009.herokuapp.com/findFriend?username=".concat(r));case 4:return i=e.sent,e.next=7,i.json();case 7:(u=e.sent).socketid&&(s(u.socketid),t.emit("send invite",{currentSocket:c,username:a,socketid:u.socketid}),n.target.childNodes[0].nodeValue="Invite sent",n.target.style.backgroundColor="transparent",n.target.style.border="none",n.target.style.color="rgba(0,255,0,0.8)",n.target.disabled=!0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{id:i,value:i,className:"friendBlock",children:[Object(l.jsxs)("div",{className:"friendText",children:[Object(l.jsx)("h3",{children:i}),Object(l.jsx)("button",{className:"btn"+i,onClick:function(e){"Invite"===e.target.innerHTML?f(e):"Accept"===e.target.innerHTML&&(s(j),t.emit("send go to game",j),h("game"))},id:i,children:"Invite"})]}),Object(l.jsx)("div",{id:d,className:d})]})}),N=(n(208),function(e){var t=e.unsortedFriends,n=e.setUnsortedFriends,s=e.socket,c=e.route,a=e.setFriendSocket,h=e.currentSocket,j=e.username,f=e.showOnlineStatusToFriends,b=e.setRoute,p=Object(r.useState)([]),m=Object(d.a)(p,2),x=m[0],g=m[1],O=Object(r.useState)(""),v=Object(d.a)(O,2),k=v[0],y=v[1],w=Object(r.useState)(""),S=Object(d.a)(w,2),N=S[0],F=S[1],q=Object(r.useState)(0),E=Object(d.a)(q,2),I=E[0],L=E[1];Object(r.useEffect)((function(){U(),f();var e=setInterval(T,5e3);return s.on("update friend status",(function(){clearInterval(e),U(),e=setInterval(T,5e3)})),function(){s.off("update friend status")}}),[]),Object(r.useEffect)((function(){R()}),[t]),Object(r.useEffect)((function(){U()}),[I]);var R=function(){var e=[],n=[],r=[];t.forEach((function(t){t.name===N?(t.status,r.push(t)):"online"===t.status?e.push(t):n.push(t)})),r.length?g(r.concat(e).concat(n)):g(e.concat(n))},T=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://calm-ridge-60009.herokuapp.com/getFriendsOnline?username=".concat(j));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,I!==n&&L(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.next=4,fetch("https://calm-ridge-60009.herokuapp.com/getFriends?username=".concat(j));case 4:if((n=e.sent).ok){e.next=7;break}throw new Error("Problem accessing friends list");case 7:return e.next=9,n.json();case 9:null!==(r=e.sent)&&""!==r&&(t=r.split(","),P(t)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(u.a)(o.a.mark((function e(t){var r,s,c,a,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],s=Object(i.a)(t),e.prev=2,s.s();case 4:if((c=s.n()).done){e.next=23;break}return a=c.value,e.prev=6,e.next=9,fetch("https://calm-ridge-60009.herokuapp.com/findFriend?username=".concat(a));case 9:if((u=e.sent).ok){e.next=12;break}throw new Error("User does not exist");case 12:return e.next=14,u.json();case 14:(d=e.sent).socketid?r.push({name:d.username,status:"online"}):r.push({name:d.username,status:"offline"}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),console.log(e.t0);case 21:e.next=4;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(2),s.e(e.t1);case 28:return e.prev=28,s.f(),e.finish(28);case 31:n(r);case 32:case"end":return e.stop()}}),e,null,[[2,25,28,31],[6,18]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r,c,a,i,u,d,l,h,f,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.querySelector(".addFriendInput").value="",t=document.querySelector(".friendsContainer"),n="",r="",c="",a=[],e.prev=6,e.next=9,fetch("https://calm-ridge-60009.herokuapp.com/getFriendRequests?username=".concat(j));case 9:if((i=e.sent).ok){e.next=12;break}throw new Error("Could not get friend requests");case 12:return e.next=14,i.json();case 14:if(null===(u=e.sent)||""===u){e.next=21;break}if(d=u.split(","),console.log(d),!d.includes(N)){e.next=21;break}throw t.style.setProperty("--add-friend-alert",'"User already sent you a request"'),new Error("User already sent you a request");case 21:return e.next=23,fetch("https://calm-ridge-60009.herokuapp.com/findFriend?username=".concat(N));case 23:if((l=e.sent).ok){e.next=27;break}throw t.style.setProperty("--add-friend-alert",'"User does not exist"'),new Error("User does not exist");case 27:return e.next=29,l.json();case 29:if((h=e.sent).username!==j){e.next=35;break}throw t.style.setProperty("--add-friend-alert",'"Cannot add yourself as a friend"'),new Error("Cannot add self as friend");case 35:if(!h.username){e.next=61;break}if(n=h.username,r=h.socketid,f=[],null!==h.friends&&""!==h.friends&&(f=h.friends.split(",")),null===h.friendrequests||""===h.friendrequests){e.next=56;break}if(!(a=h.friendrequests.split(",")).includes(j)){e.next=47;break}throw t.style.setProperty("--add-friend-alert",'"You have already sent them a request"'),new Error("You have already sent them a request");case 47:if(!f.includes(j)){e.next=52;break}throw t.style.setProperty("--add-friend-alert",'"User is already your friend"'),new Error("User is already your friend");case 52:a.push(j),c=h.friendrequests.concat(",".concat(j));case 54:e.next=61;break;case 56:if(!f.includes(j)){e.next=59;break}throw t.style.setProperty("--add-friend-alert",'"User is already your friend"'),new Error("User is already your friend");case 59:c=j,a=[j];case 61:return t.style.setProperty("--add-friend-alert",'""'),e.next=64,fetch("https://calm-ridge-60009.herokuapp.com/updateFriendRequests",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestlist:c,username:n})});case 64:if((b=e.sent).ok){e.next=67;break}throw new Error("Could not add self to friendrequests of friend");case 67:return e.next=69,b.json();case 69:e.sent&&(console.log("self added to friends list"),s.emit("send friend request",r)),e.next=76;break;case 73:e.prev=73,e.t0=e.catch(6),console.log(e.t0);case 76:case"end":return e.stop()}}),e,null,[[6,73]])})));return function(){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"friendsContainer",children:[Object(l.jsxs)("div",{className:"friendsContainerHeader",children:[Object(l.jsx)("h2",{children:"Friends"}),Object(l.jsx)("input",{className:"friendSearch",onChange:function(e){return y(e.target.value)},type:"text",placeholder:"Enter a username"})]}),Object(l.jsxs)("div",{className:"friendsSection",children:[Object(l.jsx)("div",{className:"friendsListContainer",children:x.length?Object(l.jsx)("div",{className:"friendsList",children:x.map((function(e){return e.name.toLowerCase().includes(k.toLowerCase())?Object(l.jsx)(C,{socket:s,route:c,setFriendSocket:a,currentSocket:h,username:j,fetchFriends:U,name:e.name,status:e.status,setRoute:b},e.name):null}))}):Object(l.jsx)("h4",{className:"noFriends",children:"No friends have been added"})}),Object(l.jsxs)("div",{className:"addFriend",children:[Object(l.jsx)("h3",{className:"addFriendText",children:"Add a friend"}),Object(l.jsx)("input",{className:"addFriendInput",onChange:function(e){return F(e.target.value)},type:"text",placeholder:"Enter a username"}),Object(l.jsx)("button",{className:"friendRequestBtn",onClick:B,children:"Send Request"})]})]})]})}),F=function(e){var t=e.onRouteChange;return Object(l.jsxs)("div",{className:"friendsContainer",children:[Object(l.jsx)("div",{className:"friendsContainerHeader",children:Object(l.jsx)("h2",{children:"Friends"})}),Object(l.jsx)("div",{className:"logToSeeFriendsText",children:Object(l.jsx)("h3",{children:"Log in to see your friends here"})}),Object(l.jsx)("div",{className:"homeLeaderboard",children:Object(l.jsx)("button",{value:"goToLeaderboard",onClick:t,children:"Leaderboard"})})]})},q=(n(471),function(){return Object(l.jsxs)("div",{className:"homeText",children:[Object(l.jsx)("h1",{children:"Play Battleship with your friends!"}),Object(l.jsx)("h3",{children:"Log in or make an account to continue"})]})}),E=(n(209),function(e){var t=e.onRouteChange,n=e.loadUser,s=e.currentSocket,c=Object(r.useState)(""),a=Object(d.a)(c,2),i=a[0],h=a[1],j=Object(r.useState)(""),f=Object(d.a)(j,2),b=f[0],p=f[1],m=document.querySelector(".logReg"),x=function(){var e=Object(u.a)(o.a.mark((function e(r){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://calm-ridge-60009.herokuapp.com/login",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:b,socketid:s})});case 3:return c=e.sent,e.next=6,c.json();case 6:(a=e.sent).username?(n(a),t(r)):null!==m&&m.style.setProperty("--reg-log-alert",'"The username or password you entered is incorrect"'),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"logReg",children:[Object(l.jsx)("h1",{children:"Log In"}),Object(l.jsxs)("div",{className:"username",children:[Object(l.jsx)("h4",{children:"Username"}),Object(l.jsx)("input",{onChange:function(e){return h(e.target.value)},type:"text"})]}),Object(l.jsxs)("div",{className:"password",children:[Object(l.jsx)("h4",{children:"Password"}),Object(l.jsx)("input",{onChange:function(e){return p(e.target.value)},type:"password"})]}),Object(l.jsx)("button",{className:"loginBtn",value:"login",onClick:x,children:"Login"}),Object(l.jsx)("button",{value:"goToRegister",onClick:t,className:"changeLogReg",children:"Register"})]})}),I=function(e){var t=e.onRouteChange,n=e.loadUser,s=e.currentSocket,c=Object(r.useState)(""),a=Object(d.a)(c,2),o=a[0],i=a[1],u=Object(r.useState)(""),h=Object(d.a)(u,2),j=h[0],f=h[1],b=document.querySelector(".logReg");return Object(l.jsxs)("div",{className:"logReg",children:[Object(l.jsx)("h1",{children:"Register"}),Object(l.jsxs)("div",{className:"username",children:[Object(l.jsx)("h4",{children:"Username"}),Object(l.jsx)("input",{onChange:function(e){return i(e.target.value)},type:"text"})]}),Object(l.jsxs)("div",{className:"password",children:[Object(l.jsx)("h4",{children:"Password"}),Object(l.jsx)("input",{onChange:function(e){return f(e.target.value)},type:"password"})]}),Object(l.jsx)("button",{className:"registerBtn",value:"register",onClick:function(e){o.length<5?b.style.setProperty("--reg-log-alert",'"Username must be at least 5 characters"'):o.length>10?b.style.setProperty("--reg-log-alert",'"Username cannot be more than 10 characters"'):j.length<5?b.style.setProperty("--reg-log-alert",'"Password must be at least 5 characters"'):fetch("https://calm-ridge-60009.herokuapp.com/register",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:j,socketid:s})}).then((function(e){return e.json()})).then((function(r){r.username?(n(r),t(e)):r.ok||(b.style.setProperty("--reg-log-alert",'"Username has already been taken"'),console.log(r))}))},children:"Register"}),Object(l.jsx)("button",{value:"goToLogin",onClick:t,className:"changeLogReg",children:"Login"})]})},L=function(e){var t=e.route,n=e.onRouteChange,s=e.setUnsortedFriends,c=e.socket,a=e.username,i=Object(r.useState)([]),h=Object(d.a)(i,2),j=h[0],f=h[1];Object(r.useEffect)((function(){b()}),[]);var b=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=0;case 2:if(!(n<5)){e.next=15;break}return e.next=5,fetch("https://calm-ridge-60009.herokuapp.com/getTopFive?userNum=".concat(n));case 5:if((r=e.sent).ok){e.next=8;break}throw new Error("Error");case 8:return e.next=10,r.json();case 10:s=e.sent,t.push({name:s.username,wins:s.wins});case 12:n++,e.next=2;break;case 15:f(t);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(v,{route:t,onRouteChange:n,setUnsortedFriends:s,socket:c,username:a}),j.length?Object(l.jsx)("div",{className:"topFive",children:j.map((function(e){return Object(l.jsxs)("h3",{className:"LBplayer",children:[" ",e.name," : ",e.wins," "]})}))}):null]})},R=n(228),T=n.n(R)()("https://safe-mesa-81492.herokuapp.com/");n(501),n(502),n(503),n(504);var U=function(){var e=Object(r.useState)("login"),t=Object(d.a)(e,2),n=t[0],s=t[1],c=Object(r.useState)({username:"",wins:0}),a=Object(d.a)(c,2),h=a[0],j=a[1],f=Object(r.useState)(null),b=Object(d.a)(f,2),p=b[0],m=b[1],x=Object(r.useState)(null),g=Object(d.a)(x,2),O=g[0],y=g[1],C=Object(r.useState)([]),R=Object(d.a)(C,2),U=R[0],P=R[1];Object(r.useEffect)((function(){T.on("disconnect",(function(){})),T.on("connect",(function(){m(T.id)}))}),[]);var B=function(e){switch(e.target.value){case"goToRegister":s("register"),A(!0);break;case"goToLogin":s("login"),A(!0);break;case"goHome":s("loggedIn");break;case"goToLeaderboard":s("leaderboard");break;case"login":case"register":s("loggedIn");break;case"game":s("game");break;default:s("login"),A(!0)}},H=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r,s,c,a,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.next=4,fetch("https://calm-ridge-60009.herokuapp.com/getFriends?username=".concat(h.username));case 4:if((n=e.sent).ok){e.next=7;break}throw new Error("Error");case 7:return e.next=9,n.json();case 9:null!==(r=e.sent)&&""!==r&&(t=r.split(",")),s=Object(i.a)(t),e.prev=12,s.s();case 14:if((c=s.n()).done){e.next=27;break}return a=c.value,e.next=18,fetch("https://calm-ridge-60009.herokuapp.com/findFriend?username=".concat(a));case 18:if((u=e.sent).ok){e.next=21;break}throw new Error("Error");case 21:return e.next=23,u.json();case 23:(d=e.sent).socketid&&T.emit("update user status",d.socketid);case 25:e.next=14;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(12),s.e(e.t0);case 32:return e.prev=32,s.f(),e.finish(32);case 35:e.next=40;break;case 37:e.prev=37,e.t1=e.catch(1),console.log(e.t1);case 40:case"end":return e.stop()}}),e,null,[[1,37],[12,29,32,35]])})));return function(){return e.apply(this,arguments)}}(),J=function(e){j({username:e.username,wins:e.wins})},A=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://calm-ridge-60009.herokuapp.com/removeUserSocket",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:h.username})});case 2:return n=e.sent,e.next=5,n.json();case 5:e.sent&&t&&H();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return window.addEventListener("beforeunload",(function(e){e.preventDefault(),A(!1),e.returnValue=""})),document.onkeydown=function(e){var t=document.querySelector(".loginBtn"),r=document.querySelector(".registerBtn"),s=document.querySelector(".friendRequestBtn");13===e.keyCode&&"login"===n?(e.preventDefault(),t.click()):13===e.keyCode&&"register"===n?(e.preventDefault(),r.click()):13===e.keyCode&&"loggedIn"===n&&(e.preventDefault(),s.click())},"login"===n||"register"===n?Object(l.jsxs)("div",{className:"homePage",children:[Object(l.jsx)(F,{onRouteChange:B}),Object(l.jsx)(S,{route:n}),Object(l.jsx)(q,{}),"login"===n?Object(l.jsx)(E,{currentSocket:p,loadUser:J,onRouteChange:B}):Object(l.jsx)(I,{currentSocket:p,loadUser:J,onRouteChange:B}),Object(l.jsx)(k,{})]}):Object(l.jsx)(l.Fragment,{children:"loggedIn"===n?Object(l.jsxs)("div",{className:"homePageLogged",children:[Object(l.jsx)(v,{setUnsortedFriends:P,socket:T,username:h.username,onRouteChange:B,route:n}),Object(l.jsx)(N,{unsortedFriends:U,setUnsortedFriends:P,socket:T,route:n,setFriendSocket:y,currentSocket:p,showOnlineStatusToFriends:H,username:h.username,setRoute:s}),Object(l.jsx)(S,{route:n}),Object(l.jsx)(k,{})]}):Object(l.jsx)(l.Fragment,{children:"leaderboard"===n?Object(l.jsxs)("div",{className:"leaderboard",children:[Object(l.jsx)(L,{route:n,onRouteChange:B,setUnsortedFriends:P,socket:T,username:h.username}),Object(l.jsx)(k,{})]}):Object(l.jsx)(w,{setRoute:s,setUnsortedFriends:P,socket:T,username:h.username,onRouteChange:B,route:n,friendSocket:O})})})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,511)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),s(e),c(e),a(e)}))};c.a.render(Object(l.jsx)("div",{children:Object(l.jsx)(U,{})}),document.getElementById("root")),P()}},[[505,1,2]]]);
//# sourceMappingURL=main.7e398aa4.chunk.js.map